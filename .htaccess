# ================================================================================
# Apache Configuration - OTT API
# ================================================================================

# Activer le moteur de réécriture + PATH_INFO
RewriteEngine On
AcceptPathInfo On

# Redirection racine vers index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^$ index.php [L]

# Routes API - TOUT ce qui commence par api.php/ va vers api.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api\.php/(.*)$ api.php/$1 [QSA,L]

# Routes API directes - api.php sans slash final
RewriteCond %{REQUEST_URI} ^/api\.php$
RewriteRule ^ - [L]

# S'assurer que api.php est exécuté par PHP
<FilesMatch "^api\.php$">
    SetHandler application/x-httpd-php
</FilesMatch>

# Forcer 200 pour les routes API (évite 404 Apache)
<FilesMatch "^api\.php$">
    ErrorDocument 404 /api.php
</FilesMatch>

# Pour les fichiers statiques (dashboard, doc)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Index directory listing désactivé
Options -Indexes

