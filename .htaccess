# ================================================================================
# Apache Configuration - OTT API
# ================================================================================

# Activer le moteur de réécriture + PATH_INFO
RewriteEngine On
AcceptPathInfo On

# Permettre CORS (les headers sont aussi définis dans api.php pour compatibilité avec PHP built-in server)
Header set Access-Control-Allow-Origin "*"
Header set Access-Control-Allow-Methods "GET, POST, PUT, PATCH, DELETE, OPTIONS"
Header set Access-Control-Allow-Headers "Content-Type, Authorization, X-Device-ICCID, X-Requested-With, Cache-Control, Accept"

# Redirection racine vers index.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^$ index.php [L]

# Forcer les routes api.php/... vers api.php
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteRule ^api\.php/(.*)$ api.php [QSA,L]

# Garder les routes api.php directes intactes
RewriteCond %{REQUEST_URI} ^/api\.php$
RewriteRule ^ - [L]

# Pour les fichiers statiques (dashboard, doc)
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

# Index directory listing désactivé
Options -Indexes

