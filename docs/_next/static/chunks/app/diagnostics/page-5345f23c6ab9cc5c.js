(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[353],{3154:function(e,s,t){Promise.resolve().then(t.bind(t,3742))},3742:function(e,s,t){"use strict";t.d(s,{default:function(){return n}});var a=t(7437),r=t(2265);let l=e=>e?e.replace(/\/+$/,""):"";function n(){let e=l("https://ott-jbln.onrender.com")||window.location.origin,[s,t]=(0,r.useState)(e),[n,d]=(0,r.useState)(!1),[i,c]=(0,r.useState)(null),[o,x]=(0,r.useState)(null),[m,u]=(0,r.useState)(null),p=(0,r.useMemo)(()=>[{label:"NEXT_PUBLIC_API_URL",value:"https://ott-jbln.onrender.com"},{label:"NEXT_PUBLIC_REQUIRE_AUTH",value:"true"},{label:"NEXT_PUBLIC_BASE_PATH",value:"/OTT"}],[]),h=async e=>{d(!0),c(null),x(null);try{let s=await fetch(e,{headers:{Accept:"application/json"}});if(!s.ok)throw Error("HTTP ".concat(s.status," ").concat(s.statusText));let t=await s.json();x(t),u(new Date)}catch(e){c(e.message)}finally{d(!1)}};return(0,r.useEffect)(()=>{e&&h(e)},[e]),(0,a.jsxs)("div",{className:"max-w-4xl mx-auto space-y-6",children:[(0,a.jsxs)("section",{className:"bg-white rounded-xl shadow p-6 border border-gray-100",children:[(0,a.jsxs)("header",{className:"flex items-center justify-between flex-wrap gap-3",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm text-primary font-semibold uppercase tracking-wider",children:"Diagnostic temps r\xe9el"}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Statut API & Base de donn\xe9es"})]}),(0,a.jsxs)("span",{className:"px-3 py-1 text-sm rounded-md bg-gray-100 text-gray-700 font-medium",children:["Build ","production"]})]}),(0,a.jsxs)("form",{onSubmit:t=>{t.preventDefault();let a=l(s||e);a?h(a):c("Veuillez renseigner une URL valide.")},className:"mt-4 flex flex-wrap gap-3",children:[(0,a.jsxs)("div",{className:"flex-1 min-w-[240px]",children:[(0,a.jsx)("label",{className:"text-sm text-gray-600 font-medium",children:"URL API \xe0 tester"}),(0,a.jsx)("input",{type:"url",value:s,onChange:e=>t(e.target.value),className:"mt-1 w-full rounded-md border border-gray-300 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent",placeholder:"https://mon-api.com"})]}),(0,a.jsx)("button",{type:"submit",disabled:n,className:"self-end px-5 py-2 rounded-md bg-primary text-white font-semibold shadow disabled:opacity-60",children:n?"Test en cours…":"Tester la connexion"})]}),(0,a.jsx)("div",{className:"mt-6 rounded-lg border bg-gray-50 p-4 text-sm",children:(0,a.jsx)("p",{className:"text-gray-600",children:"Cette v\xe9rification interroge l’endpoint racine de l’API (`index.php`) qui effectue d\xe9j\xe0 un diagnostic PDO/ Postgres."})}),(0,a.jsxs)("div",{className:"mt-6",children:[i&&(0,a.jsxs)("div",{className:"rounded-md border border-red-200 bg-red-50 px-4 py-3 text-sm text-red-700",children:["❌ Impossible de contacter l’API : ",i]}),o&&(0,a.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 bg-white shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-widest",children:"API"}),(0,a.jsx)("h2",{className:"text-lg font-semibold text-gray-900",children:o.service}),(0,a.jsxs)("p",{className:"text-sm text-gray-600",children:["Version ",o.version]}),(0,a.jsxs)("dl",{className:"mt-3 space-y-1 text-sm",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Statut"}),(0,a.jsx)("dd",{className:"font-medium text-gray-900",children:o.status})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"PHP"}),(0,a.jsx)("dd",{className:"font-medium text-gray-900",children:o.php_version})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("dt",{className:"text-gray-500",children:"Base de donn\xe9es"}),(0,a.jsx)("dd",{className:"font-medium text-gray-900",children:o.database})]})]})]}),(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 bg-white shadow-sm",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-widest",children:"Horodatage"}),(0,a.jsx)("p",{className:"text-sm text-gray-900",children:o.timestamp}),m&&(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-1",children:["V\xe9rifi\xe9 le ",m.toLocaleString()]}),(0,a.jsx)("p",{className:"text-xs text-gray-500 mt-4",children:"Endpoints expos\xe9s :"}),(0,a.jsx)("ul",{className:"mt-1 space-y-1 text-xs font-mono text-gray-700 max-h-36 overflow-auto",children:o.endpoints&&Object.entries(o.endpoints).map(e=>{let[s,t]=e;return(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-primary",children:s})," — ",t]},s)})})]})]}),!o&&!i&&(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Aucun diagnostic pour le moment."})]})]}),(0,a.jsxs)("section",{className:"bg-white rounded-xl shadow p-6 border border-gray-100",children:[(0,a.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Variables front expos\xe9es"}),(0,a.jsx)("div",{className:"grid gap-3 md:grid-cols-3",children:p.map(e=>(0,a.jsxs)("div",{className:"rounded-lg border border-gray-200 p-4 bg-gray-50",children:[(0,a.jsx)("p",{className:"text-xs font-semibold text-gray-500 uppercase tracking-widest",children:e.label}),(0,a.jsx)("p",{className:"mt-1 text-sm font-mono text-gray-900 break-all",children:e.value})]},e.label))})]})]})}}},function(e){e.O(0,[971,117,744],function(){return e(e.s=3154)}),_N_E=e.O()}]);