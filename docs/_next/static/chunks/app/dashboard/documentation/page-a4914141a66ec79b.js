(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3967],{5666:function(e,t,r){Promise.resolve().then(r.bind(r,7779))},7779:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return x},dynamic:function(){return g}});var a=r(7437),s=r(2265),l=r(9376),o=r(7062),d=r(8828),n=r(9999),i=r(6705);function c(e){let{metadata:t}=e;if(!t)return null;let r=t.filters&&(t.filters.author||t.filters.since||t.filters.until),s=e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}catch(t){return e}};return(0,a.jsxs)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 rounded-lg shadow-lg p-6 mb-6 text-white",children:[(0,a.jsxs)("h2",{className:"text-xl font-bold mb-4 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDCCA"}),"Informations de l'Analyse"]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.period&&(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"P\xe9riode analys\xe9e"}),(0,a.jsxs)("div",{className:"font-semibold",children:[s(t.period.start)," - ",s(t.period.end)]})]}),t.author&&(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"D\xe9veloppeur"}),(0,a.jsx)("div",{className:"font-semibold",children:t.author})]}),t.project&&(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Projet"}),(0,a.jsx)("div",{className:"font-semibold text-sm",children:t.project})]}),t.branchesAnalyzed&&(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Branches analys\xe9es"}),(0,a.jsx)("div",{className:"font-semibold",children:t.branchesAnalyzed})]}),r&&(0,a.jsxs)("div",{className:"bg-yellow-500/30 rounded-lg p-3 backdrop-blur-sm border border-yellow-300/50",children:[(0,a.jsxs)("div",{className:"text-xs opacity-90 mb-1 flex items-center gap-1",children:[(0,a.jsx)("span",{children:"⚠️"}),"Filtres actifs"]}),(0,a.jsxs)("div",{className:"text-sm space-y-1",children:[t.filters.author&&(0,a.jsxs)("div",{children:["Auteur: ",(0,a.jsx)("span",{className:"font-semibold",children:t.filters.author})]}),t.filters.since&&(0,a.jsxs)("div",{children:["Depuis: ",(0,a.jsx)("span",{className:"font-semibold",children:t.filters.since})]}),t.filters.until&&(0,a.jsxs)("div",{children:["Jusqu'\xe0: ",(0,a.jsx)("span",{className:"font-semibold",children:t.filters.until})]})]})]}),t.lastGenerated&&(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-3 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Derni\xe8re g\xe9n\xe9ration"}),(0,a.jsx)("div",{className:"font-semibold text-sm",children:t.lastGenerated})]})]})]})}function m(e){let{day:t,isOpen:r,onClose:s}=e;if(!r||!t)return null;let l=t.details||{};return(0,a.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm",onClick:s,children:(0,a.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-2xl max-w-4xl w-full max-h-[90vh] overflow-hidden flex flex-col",onClick:e=>e.stopPropagation(),children:[(0,a.jsx)("div",{className:"bg-gradient-to-r from-blue-500 to-purple-500 p-6 text-white",children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsxs)("div",{children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-2",children:["\uD83D\uDCC5 ",(e=>{if(!e)return"-";try{return new Date(e).toLocaleDateString("fr-FR",{weekday:"long",day:"numeric",month:"long",year:"numeric"})}catch(t){return e}})(t.date)]}),(0,a.jsxs)("div",{className:"text-sm opacity-90",children:[t.hours,"h de travail • ",t.commits," commits"]})]}),(0,a.jsx)("button",{onClick:s,className:"text-white hover:bg-white/20 rounded-full p-2 transition-colors","aria-label":"Fermer",children:(0,a.jsx)("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})}),(0,a.jsxs)("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"D\xe9veloppement"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:t.dev||0})]}),(0,a.jsxs)("div",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Correction"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:t.fix||0})]}),(0,a.jsxs)("div",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Test"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-yellow-600 dark:text-yellow-400",children:t.test||0})]}),(0,a.jsxs)("div",{className:"bg-green-50 dark:bg-green-900/20 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm text-gray-600 dark:text-gray-400 mb-1",children:"Documentation"}),(0,a.jsx)("div",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:t.doc||0})]})]}),l.advances&&l.advances.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"✨"}),"Avanc\xe9es principales (",l.advances.length,")"]}),(0,a.jsx)("ul",{className:"space-y-2",children:l.advances.map((e,t)=>(0,a.jsx)("li",{className:"bg-blue-50 dark:bg-blue-900/20 rounded-lg p-3 border-l-4 border-blue-500",children:(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})},t))})]}),l.fixes&&l.fixes.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDD27"}),"Probl\xe8mes r\xe9solus (",l.fixes.length,")"]}),(0,a.jsx)("ul",{className:"space-y-2",children:l.fixes.map((e,t)=>(0,a.jsx)("li",{className:"bg-red-50 dark:bg-red-900/20 rounded-lg p-3 border-l-4 border-red-500",children:(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})},t))})]}),l.deployments&&l.deployments.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83D\uDE80"}),"Red\xe9ploiements (",l.deployments.length,")"]}),(0,a.jsx)("ul",{className:"space-y-2",children:l.deployments.map((e,t)=>(0,a.jsx)("li",{className:"bg-purple-50 dark:bg-purple-900/20 rounded-lg p-3 border-l-4 border-purple-500",children:(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})},t))})]}),l.tests&&l.tests.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold mb-3 flex items-center gap-2",children:[(0,a.jsx)("span",{children:"\uD83E\uDDEA"}),"Tests (",l.tests.length,")"]}),(0,a.jsx)("ul",{className:"space-y-2",children:l.tests.map((e,t)=>(0,a.jsx)("li",{className:"bg-yellow-50 dark:bg-yellow-900/20 rounded-lg p-3 border-l-4 border-yellow-500",children:(0,a.jsx)("div",{className:"text-sm text-gray-700 dark:text-gray-300",children:e})},t))})]}),(!l.advances||0===l.advances.length)&&(!l.fixes||0===l.fixes.length)&&(!l.deployments||0===l.deployments.length)&&(!l.tests||0===l.tests.length)&&(0,a.jsx)("div",{className:"text-center py-8 text-gray-500 dark:text-gray-400",children:(0,a.jsx)("p",{children:"Aucun d\xe9tail disponible pour ce jour"})})]}),(0,a.jsx)("div",{className:"border-t border-gray-200 dark:border-gray-700 p-4 flex justify-end",children:(0,a.jsx)("button",{onClick:s,className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors",children:"Fermer"})})]})})}var u=r(4084);let g="force-dynamic";u.kL.register(u.uw,u.f$,u.ZL,u.qi,u.od,u.jn,u.Dx,u.u,u.De,u.Gu);let h={presentation:"DOCUMENTATION_PRESENTATION.html",developpeurs:"DOCUMENTATION_DEVELOPPEURS.html",commerciale:"DOCUMENTATION_COMMERCIALE.html","suivi-temps":"SUIVI_TEMPS_FACTURATION.md",database:null};function x(){let e=(0,l.useSearchParams)().get("doc")||"presentation",t=(0,s.useMemo)(()=>{let t=h[e]||h.presentation;return t.endsWith(".md")?null:(0,o.wE)("/docs/".concat(t))},[e]);(0,s.useEffect)(()=>{let t={presentation:"Documentation Pr\xe9sentation - OTT Dashboard",developpeurs:"Documentation D\xe9veloppeurs - OTT Dashboard",commerciale:"Documentation Commerciale - OTT Dashboard","suivi-temps":"Suivi Temps - OTT Dashboard"};document.title=t[e]||t.presentation},[e]);let r="suivi-temps"===e,n="database"===e,i=(0,s.useRef)(null),c=(0,s.useCallback)(()=>{var e;if(!r&&(null===(e=i.current)||void 0===e?void 0:e.contentWindow))try{let e=document.documentElement.classList.contains("dark");i.current.contentWindow.postMessage({type:"theme",isDark:e},"*")}catch(e){d.Z.error("Erreur envoi th\xe8me \xe0 iframe:",e)}},[r]);return((0,s.useEffect)(()=>{if(r)return;let e=e=>{e.data&&"request-theme"===e.data.type&&c()};window.addEventListener("message",e),c();let t=new MutationObserver(c);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>{t.disconnect(),window.removeEventListener("message",e)}},[c,r]),r)?(0,a.jsx)(b,{fileName:"SUIVI_TEMPS_FACTURATION.md"},e):n?(0,a.jsx)(p,{}):(0,a.jsx)("div",{className:"fixed inset-0 top-16 left-64 right-0 bottom-0 -m-6 overflow-y-auto docs-scrollbar",children:(0,a.jsx)("iframe",{ref:i,src:t,className:"w-full h-full border-0",title:"Documentation OTT",allow:"fullscreen",onLoad:()=>{let e=()=>{c()};e(),setTimeout(e,100),setTimeout(e,500)}})})}function b(e){var t,r,l,u,g,h,x,b,p;let{fileName:y}=e,[f,v]=(0,s.useState)(""),[j,N]=(0,s.useState)(!0),[k,w]=(0,s.useState)(null),[D,C]=(0,s.useState)("day"),[E,S]=(0,s.useState)(!1),[T,A]=(0,s.useState)(null),[O,F]=(0,s.useState)(!1),{fetchWithAuth:I,API_URL:M}=(0,n.a)(),P=(0,s.useRef)(null),R=(0,s.useRef)(!1),Z=(0,s.useRef)(!1),L=(0,s.useRef)(0),_=(0,s.useCallback)(e=>{A(e),F(!0)},[]),H=(0,s.useCallback)(()=>{F(!1),A(null)},[]);(0,s.useEffect)(()=>{let e=()=>{let e=document.documentElement.classList.contains("dark"),t=document.getElementById("markdown-viewer-container");t&&(e?t.classList.add("dark"):t.classList.remove("dark"))};e();let t=new MutationObserver(e);return t.observe(document.documentElement,{attributes:!0,attributeFilter:["class"]}),()=>t.disconnect()},[]);let U=(0,s.useCallback)(async()=>{if(!R.current){R.current=!0,N(!0);try{let e="",t=null;for(let r of[async()=>{let e=(0,o.wE)("/".concat(y)),t=await fetch(e+"?t="+Date.now());if(t.ok)return await t.text();throw Error("HTTP ".concat(t.status))},async()=>{let e=await fetch("/".concat(y,"?t=").concat(Date.now()));if(e.ok)return await e.text();throw Error("HTTP ".concat(e.status))},async()=>{let e=await fetch("".concat("https://ott-jbln.onrender.com","/api.php/docs/").concat(y,"?t=").concat(Date.now()));if(e.ok)return await e.text();throw Error("API HTTP ".concat(e.status))}])try{if(e=await r())break}catch(e){t=e,d.Z.debug("M\xe9thode de chargement \xe9chou\xe9e: ".concat(e.message));continue}if(!e)throw Error("Impossible de charger ".concat(y,". ")+"V\xe9rifiez que le fichier existe dans public/ ou que l'API est accessible. "+"Derni\xe8re erreur: ".concat((null==t?void 0:t.message)||"Inconnue"));v(e);let r=function(e){let t,r;let a={metadata:null,dailyData:[],categories:{Développement:0,Correction:0,Test:0,Documentation:0,Refactoring:0,Déploiement:0,"UI/UX":0,Optimisation:0},totalHours:0,totalCommits:0,totalHoursFromMarkdown:0,totalCommitsFromMarkdown:0,validation:{hoursMatch:!0,commitsMatch:!0,categoriesMatch:!0}},s={},l=e.match(/\*\*Période analysée\*\* : (\d{4}-\d{2}-\d{2}) - (\d{4}-\d{2}-\d{2})/);l&&(s.period={start:l[1],end:l[2]});let o=e.match(/\*\*Développeur\*\* : (.+)/);o&&(s.author=o[1].trim());let n=e.match(/\*\*Projet\*\* : (.+)/);n&&(s.project=n[1].trim());let i=e.match(/\*\*Total commits analysés\*\* : (\d+)/);i&&(s.totalCommits=parseInt(i[1]));let c=e.match(/\*\*Branches analysées\*\* : (.+)/);c&&(s.branchesAnalyzed=c[1].trim()),s.filters={};let m=e.match(/\*\*Auteur filtré\*\* : (.+)/);m&&(s.filters.author=m[1].trim());let u=e.match(/\*\*Depuis\*\* : (.+)/);u&&(s.filters.since=u[1].trim());let g=e.match(/\*\*Jusqu'à\*\* : (.+)/);g&&(s.filters.until=g[1].trim());let h=e.match(/\*\*Dernière génération\*\* : (.+)/);h&&(s.lastGenerated=h[1].trim()),Object.keys(s).length>0&&(a.metadata=s);let x=/\| (\d{4}-\d{2}-\d{2}) \| ~?([\d.]+)h? \| (\d+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \| ([\d.-]+) \|/g;for(;null!==(t=x.exec(e));){let e=t[1],r=z(t[2]),s=q(t[3]),l=z(t[4]),o=z(t[5]),d=z(t[6]),n=z(t[7]),i=z(t[8]),c=z(t[9]),m=z(t[10]),u=z(t[11]);!e.includes("---")&&e.match(/^\d{4}-\d{2}-\d{2}$/)&&(a.dailyData.push({date:e,hours:r,commits:s,dev:l,fix:o,test:d,doc:n,refactor:i,deploy:c,uiux:m,optim:u,details:null}),a.totalHours+=r,a.totalCommits+=s)}let b=e.match(/(?:\*\*)?Total(?:\*\*)? \| (?:\*\*)?~?([\d.]+)h?(?:\*\*)? \| (?:\*\*)?(\d+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)? \| (?:\*\*)?([\d.]+)(?:\*\*)?/);if(b){a.totalHoursFromMarkdown=z(b[1]),a.totalCommitsFromMarkdown=q(b[2]),a.totalHours=a.totalHoursFromMarkdown,a.totalCommits=a.totalCommitsFromMarkdown,a.categories["D\xe9veloppement"]=z(b[3]),a.categories.Correction=z(b[4]),a.categories.Test=z(b[5]),a.categories.Documentation=z(b[6]),a.categories.Refactoring=z(b[7]),a.categories["D\xe9ploiement"]=z(b[8]),a.categories["UI/UX"]=z(b[9]),a.categories.Optimisation=z(b[10]);let e=a.dailyData.reduce((e,t)=>e+t.hours,0),t=a.dailyData.reduce((e,t)=>e+t.commits,0),r=Math.abs(e-a.totalHoursFromMarkdown),s=Math.abs(t-a.totalCommitsFromMarkdown);a.validation.hoursMatch=r<.1,a.validation.commitsMatch=0===s,a.validation.hoursMatch||d.Z.warn("\xc9cart d\xe9tect\xe9 pour les heures: calcul\xe9=".concat(e.toFixed(1),", markdown=").concat(a.totalHoursFromMarkdown.toFixed(1))),a.validation.commitsMatch||d.Z.warn("\xc9cart d\xe9tect\xe9 pour les commits: calcul\xe9=".concat(t,", markdown=").concat(a.totalCommitsFromMarkdown))}let p=/### (\d{1,2} \w+ \d{4})\s+[\s\S]*?(?=###|$)/g;for(;null!==(r=p.exec(e));){let e=r[0],t=r[1],s=null;try{let e=t.match(/(\d{1,2}) (\w+) (\d{4})/);if(e){let t=parseInt(e[1]),r=e[2].toLowerCase(),a=parseInt(e[3]),l={janvier:0,février:1,mars:2,avril:3,mai:4,juin:5,juillet:6,août:7,septembre:8,octobre:9,novembre:10,décembre:11}[r];void 0!==l&&(s=new Date(a,l,t).toISOString().split("T")[0])}}catch(e){d.Z.warn("Erreur parsing date d\xe9tail:",e)}if(!s)continue;let l=a.dailyData.findIndex(e=>e.date===s);if(-1===l)continue;let o={advances:[],fixes:[],deployments:[],tests:[]},n=e.match(/#### Avancées principales\s+([\s\S]*?)(?=####|$)/);if(n){let e=n[1].match(/- \[FEAT\] (.+)/g);e&&(o.advances=e.map(e=>e.replace(/- \[FEAT\] /,"").trim()))}let i=e.match(/#### Problèmes résolus\s+([\s\S]*?)(?=####|$)/);if(i){let e=i[1].match(/- \[FIX\] (.+)/g);e&&(o.fixes=e.map(e=>e.replace(/- \[FIX\] /,"").trim()))}let c=e.match(/#### Redéploiements\s+([\s\S]*?)(?=####|$)/);if(c){let e=c[1].match(/- \[DEPLOY\] (.+)/g);e&&(o.deployments=e.map(e=>e.replace(/- \[DEPLOY\] /,"").trim()))}let m=e.match(/#### Tests\s+([\s\S]*?)(?=####|$)/);if(m){let e=m[1].match(/- \[TEST\] (.+)/g);e&&(o.tests=e.map(e=>e.replace(/- \[TEST\] /,"").trim()))}(o.advances.length>0||o.fixes.length>0||o.deployments.length>0||o.tests.length>0)&&(a.dailyData[l].details=o)}return a.dailyData.sort((e,t)=>new Date(e.date)-new Date(t.date)),a}(e);w(r)}catch(e){d.Z.error("Erreur chargement markdown:",e),v("# Erreur de chargement\n\nImpossible de charger le document **".concat(y,"**.\n\n**D\xe9tails :** ").concat(e.message,"\n\n**Solutions possibles :**\n- V\xe9rifiez que le fichier existe dans le dossier `public/`\n- V\xe9rifiez que l'API backend est accessible\n- V\xe9rifiez votre connexion r\xe9seau"))}finally{N(!1),R.current=!1}}},[y]),W=(0,s.useCallback)(async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if("SUIVI_TEMPS_FACTURATION.md"===y&&(!E||e)){S(!0);try{d.Z.debug("\uD83D\uDD04 R\xe9g\xe9n\xe9ration du fichier de suivi du temps...");let e=await I("".concat(M,"/api.php/docs/regenerate-time-tracking"),{method:"POST"},{requiresAuth:!0});if(e.ok){let t=await e.json();d.Z.debug("✅ Fichier r\xe9g\xe9n\xe9r\xe9 avec succ\xe8s:",t),L.current=Date.now(),await new Promise(e=>setTimeout(e,1e3)),await U()}else{if(501===e.status){await e.json().catch(()=>({})),d.Z.debug("ℹ️ R\xe9g\xe9n\xe9ration automatique non disponible sur ce serveur (non-Windows). Le fichier existant sera utilis\xe9.");return}let t=await e.json().catch(()=>({}));d.Z.warn("⚠️ Erreur lors de la r\xe9g\xe9n\xe9ration:",t);return}}catch(e){d.Z.debug("ℹ️ R\xe9g\xe9n\xe9ration non disponible (non bloquant):",e.message);return}finally{S(!1)}}},[y,M,I,E,U]);function z(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e||"-"===e||""===e||"0"===e)return t;let r=parseFloat(e);return isNaN(r)?t:r}function q(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e||"-"===e||""===e||"0"===e)return t;let r=parseInt(e);return isNaN(r)?t:r}(0,s.useEffect)(()=>{P.current!==y&&(P.current=y,Z.current=!1,L.current=0),R.current||(async()=>{await U()})()},[y,W,U]);let J=(0,s.useMemo)(()=>{if(!k)return null;switch(D){case"week":return function(e){let t={};return e.forEach(e=>{let r=new Date(e.date),a=new Date(r);a.setDate(r.getDate()-r.getDay());let s=a.toISOString().split("T")[0];t[s]||(t[s]={date:s,label:"Sem. ".concat(a.getDate(),"/").concat(a.getMonth()+1),hours:0,commits:0,days:0}),t[s].hours+=e.hours,t[s].commits+=e.commits,t[s].days+=1}),Object.values(t).sort((e,t)=>new Date(e.date)-new Date(t.date))}(k.dailyData);case"month":return function(e){let t={};return e.forEach(e=>{let r=new Date(e.date),a="".concat(r.getFullYear(),"-").concat(String(r.getMonth()+1).padStart(2,"0"));t[a]||(t[a]={date:a,label:r.toLocaleDateString("fr-FR",{month:"long",year:"numeric"}),hours:0,commits:0,days:0}),t[a].hours+=e.hours,t[a].commits+=e.commits,t[a].days+=1}),Object.values(t).sort((e,t)=>new Date(e.date)-new Date(t.date))}(k.dailyData);default:return k.dailyData}},[k,D]),V=(0,s.useMemo)(()=>{if(!k||!k.dailyData||0===k.dailyData.length)return null;try{return{avgHoursPerDay:k.totalHours/k.dailyData.length,avgCommitsPerDay:k.totalCommits/k.dailyData.length,maxHours:Math.max(...k.dailyData.map(e=>e.hours)),minHours:Math.min(...k.dailyData.map(e=>e.hours)),maxCommits:Math.max(...k.dailyData.map(e=>e.commits)),minCommits:Math.min(...k.dailyData.map(e=>e.commits)),regularity:(()=>{let e=k.totalHours/k.dailyData.length,t=k.dailyData.reduce((t,r)=>t+Math.pow(r.hours-e,2),0)/k.dailyData.length;return Math.sqrt(t)})(),byDayOfWeek:(()=>{let e={lundi:{hours:0,commits:0,days:0},mardi:{hours:0,commits:0,days:0},mercredi:{hours:0,commits:0,days:0},jeudi:{hours:0,commits:0,days:0},vendredi:{hours:0,commits:0,days:0},samedi:{hours:0,commits:0,days:0},dimanche:{hours:0,commits:0,days:0}};return k.dailyData.forEach(t=>{let r=new Date(t.date).toLocaleDateString("fr-FR",{weekday:"long"}).toLowerCase();e[r]&&(e[r].hours+=t.hours,e[r].commits+=t.commits,e[r].days+=1)}),console.log("\uD83D\uDCCA byDayOfWeek calcul\xe9:",e),e})()}}catch(e){return d.Z.error("Erreur calcul stats:",e),null}},[k]);J&&(J.map(e=>e.label||new Date(e.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})),J.map(e=>e.commits));let $=J?{labels:J.map(e=>e.label||new Date(e.date).toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit"})),datasets:[{label:"day"===D?"Heures par jour":"week"===D?"Heures par semaine":"Heures par mois",data:J.map(e=>e.hours),borderColor:"rgb(81, 207, 102)",backgroundColor:"rgba(81, 207, 102, 0.1)",fill:!0,tension:.4,borderWidth:2}]}:null,B=(0,s.useMemo)(()=>{if(!k||!k.categories)return null;try{let e={Développement:{bg:"rgba(59, 130, 246, 0.8)",border:"rgb(59, 130, 246)"},Correction:{bg:"rgba(239, 68, 68, 0.8)",border:"rgb(239, 68, 68)"},Test:{bg:"rgba(168, 85, 247, 0.8)",border:"rgb(168, 85, 247)"},Documentation:{bg:"rgba(34, 197, 94, 0.8)",border:"rgb(34, 197, 94)"},Refactoring:{bg:"rgba(245, 158, 11, 0.8)",border:"rgb(245, 158, 11)"},Déploiement:{bg:"rgba(99, 102, 241, 0.8)",border:"rgb(99, 102, 241)"},"UI/UX":{bg:"rgba(236, 72, 153, 0.8)",border:"rgb(236, 72, 153)"},Optimisation:{bg:"rgba(14, 165, 233, 0.8)",border:"rgb(14, 165, 233)"}},t=Object.keys(k.categories).filter(e=>k.categories[e]>0),r=t.map(e=>k.categories[e]),a=t.map(t=>{var r;return(null===(r=e[t])||void 0===r?void 0:r.bg)||"rgba(128, 128, 128, 0.8)"}),s=t.map(t=>{var r;return(null===(r=e[t])||void 0===r?void 0:r.border)||"rgb(128, 128, 128)"});return{labels:t,datasets:[{data:r,backgroundColor:a,borderColor:s,borderWidth:2}]}}catch(e){return d.Z.error("Erreur calcul pieChartData:",e),null}},[k]),X=(0,s.useMemo)(()=>{if(!V||!V.byDayOfWeek)return console.log("⚠️ Stats ou byDayOfWeek manquant:",{hasStats:!!V,byDayOfWeek:null==V?void 0:V.byDayOfWeek}),null;try{let e=["Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi","Dimanche"],t=["lundi","mardi","mercredi","jeudi","vendredi","samedi","dimanche"].map(e=>{let t=V.byDayOfWeek[e];if(!t||0===t.days)return 0;let r=t.hours/t.days;return parseFloat(r.toFixed(1))});return console.log("\uD83D\uDCCA Day of week chart data:",{labels:e,data:t,byDayOfWeek:V.byDayOfWeek}),{labels:e,datasets:[{label:"Heures moyennes",data:t,backgroundColor:"rgba(81, 207, 102, 0.8)",borderColor:"rgb(81, 207, 102)",borderWidth:2,borderRadius:4}]}}catch(e){return d.Z.error("Erreur calcul dayOfWeekChartData:",e),null}},[V]);(0,s.useMemo)(()=>{if(!k||!k.dailyData||0===k.dailyData.length)return null;try{return{labels:["0-2h","2-4h","4-6h","6-8h","8-10h","10h+"],datasets:[{label:"Nombre de jours",data:[k.dailyData.filter(e=>e.hours>=0&&e.hours<2).length,k.dailyData.filter(e=>e.hours>=2&&e.hours<4).length,k.dailyData.filter(e=>e.hours>=4&&e.hours<6).length,k.dailyData.filter(e=>e.hours>=6&&e.hours<8).length,k.dailyData.filter(e=>e.hours>=8&&e.hours<10).length,k.dailyData.filter(e=>e.hours>=10).length],backgroundColor:"rgba(168, 85, 247, 0.8)",borderColor:"rgb(168, 85, 247)",borderWidth:2,borderRadius:4}]}}catch(e){return d.Z.error("Erreur calcul hoursDistributionData:",e),null}},[k]);let G={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"bottom",labels:{padding:15,font:{size:12}}},tooltip:{backgroundColor:"rgba(0, 0, 0, 0.8)",padding:12,titleFont:{size:14},bodyFont:{size:13}}}},Y={...G,scales:{y:{beginAtZero:!0,grace:"10%",ticks:{stepSize:5}}}},Q={...G,scales:{y:{beginAtZero:!0,grace:"15%",ticks:{stepSize:2}}}};return j?(0,a.jsx)("div",{className:"fixed inset-0 top-16 left-64 right-0 bottom-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement..."})]})}):(0,a.jsxs)("div",{id:"markdown-viewer-container",className:"fixed inset-0 top-16 left-64 right-0 bottom-0 overflow-y-auto bg-gradient-to-b from-gray-50 to-white dark:from-[rgb(var(--night-bg-start))] dark:to-[rgb(var(--night-bg-mid))] docs-scrollbar",children:[k&&(0,a.jsx)("nav",{className:"sticky top-0 z-50 bg-gradient-to-r from-primary-600 to-secondary-600 shadow-lg",children:(0,a.jsx)("div",{className:"max-w-7xl mx-auto px-6 py-3",children:(0,a.jsxs)("div",{className:"flex flex-wrap gap-2 justify-center items-center",children:[(0,a.jsx)("a",{href:"#stats",className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-all backdrop-blur-sm",children:"\uD83D\uDCCA Statistiques"}),(0,a.jsx)("a",{href:"#regularite",className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-all backdrop-blur-sm",children:"\uD83D\uDCC8 R\xe9gularit\xe9"}),(0,a.jsx)("a",{href:"#repartition",className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-all backdrop-blur-sm",children:"\uD83E\uDD67 R\xe9partition"}),(0,a.jsx)("a",{href:"#tableau",className:"px-4 py-2 bg-white/20 hover:bg-white/30 rounded-lg text-white text-sm font-medium transition-all backdrop-blur-sm",children:"\uD83D\uDCCB Tableau"})]})})}),(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[k&&k.metadata&&(0,a.jsx)(c,{metadata:k.metadata}),k&&V&&(0,a.jsxs)("div",{id:"stats",className:"bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg shadow-lg p-6 mb-6 text-white scroll-mt-20",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-4",children:"Suivi du Temps - Projet OTT"}),(0,a.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-4",children:[(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Total Heures"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[k.totalHours.toFixed(1),"h"]}),(null===(t=k.metadata)||void 0===t?void 0:t.filters)&&Object.keys(k.metadata.filters).length>0&&(0,a.jsx)("div",{className:"text-xs mt-1 opacity-75",children:"⚠️ Filtres actifs"})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Total Commits"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.totalCommits}),k.validation&&!k.validation.commitsMatch&&(0,a.jsx)("div",{className:"text-xs mt-1 opacity-75",children:"⚠️ Validation"})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Jours Travaill\xe9s"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:k.dailyData.length})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Moyenne/jour"}),(0,a.jsxs)("div",{className:"text-2xl font-bold",children:[V.avgHoursPerDay.toFixed(1),"h"]})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"Commits/jour"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:V.avgCommitsPerDay.toFixed(1)})]}),(0,a.jsxs)("div",{className:"bg-white/20 rounded-lg p-4 backdrop-blur-sm",children:[(0,a.jsx)("div",{className:"text-xs opacity-90 mb-1",children:"R\xe9gularit\xe9"}),(0,a.jsx)("div",{className:"text-2xl font-bold",children:V.regularity<2?"\uD83D\uDFE2":V.regularity<4?"\uD83D\uDFE1":"\uD83D\uDD34"}),(0,a.jsxs)("div",{className:"text-xs mt-1",children:["σ=",V.regularity.toFixed(1),"h"]})]})]})]}),k&&(0,a.jsx)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-4 mb-6",children:(0,a.jsxs)("div",{className:"flex items-center justify-center gap-4",children:[(0,a.jsx)("span",{className:"text-sm font-medium text-gray-700 dark:text-gray-300",children:"Vue :"}),(0,a.jsx)("button",{onClick:()=>C("day"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("day"===D?"bg-primary-500 text-white shadow-md":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"Jour"}),(0,a.jsx)("button",{onClick:()=>C("week"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("week"===D?"bg-primary-500 text-white shadow-md":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"Semaine"}),(0,a.jsx)("button",{onClick:()=>C("month"),className:"px-4 py-2 rounded-lg font-medium transition-all ".concat("month"===D?"bg-primary-500 text-white shadow-md":"bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 hover:bg-gray-300 dark:hover:bg-gray-600"),children:"Mois"})]})}),k&&(0,a.jsxs)("div",{id:"regularite",className:"space-y-6 mb-6 scroll-mt-20",children:[(0,a.jsxs)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:"day"===D?"Temps Pass\xe9 par Jour":"week"===D?"Temps Pass\xe9 par Semaine":"Temps Pass\xe9 par Mois"}),(0,a.jsx)("div",{className:"h-80",children:(0,a.jsx)(i.x1,{data:$,options:Q})}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 text-center",children:"day"===D?"Heures estim\xe9es par jour":"week"===D?"Heures estim\xe9es par semaine":"Heures estim\xe9es par mois"})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,a.jsxs)("div",{id:"repartition",className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6 scroll-mt-20",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:"R\xe9partition par Activit\xe9"}),(0,a.jsx)("div",{className:"h-64 flex items-center justify-center",children:(0,a.jsx)(i.$I,{data:B,options:G})})]}),X&&(0,a.jsxs)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:"Temps par Jour de la Semaine"}),(0,a.jsx)("div",{className:"h-64",children:(0,a.jsx)(i.$Q,{data:X,options:Y})}),(0,a.jsx)("p",{className:"text-sm text-gray-600 dark:text-gray-400 mt-2 text-center",children:"Heures moyennes par jour de la semaine"})]})]})]}),k&&(0,a.jsxs)("div",{id:"tableau",className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6 mb-6 scroll-mt-20",children:[(0,a.jsx)("h3",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:"Tableau R\xe9capitulatif"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-50 dark:from-gray-800 dark:to-gray-700",children:[(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-left",children:"Date"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Heures"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Commits"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"D\xe9veloppement"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Correction"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Test"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Documentation"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Refactoring"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"D\xe9ploiement"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"UI/UX"}),(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"Optimisation"}),k.dailyData.some(e=>e.details&&(e.details.advances&&e.details.advances.length>0||e.details.fixes&&e.details.fixes.length>0||e.details.deployments&&e.details.deployments.length>0||e.details.tests&&e.details.tests.length>0))&&(0,a.jsx)("th",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-bold text-center",children:"D\xe9tails"})]})}),(0,a.jsxs)("tbody",{children:[k.dailyData.map((e,t)=>{var r,s,l,o;let d=new Date(e.date),n=e.details&&(e.details.advances&&e.details.advances.length>0||e.details.fixes&&e.details.fixes.length>0||e.details.deployments&&e.details.deployments.length>0||e.details.tests&&e.details.tests.length>0),i=n?"Avanc\xe9es: ".concat((null===(r=e.details.advances)||void 0===r?void 0:r.length)||0,", Fixes: ").concat((null===(s=e.details.fixes)||void 0===s?void 0:s.length)||0,", D\xe9ploiements: ").concat((null===(l=e.details.deployments)||void 0===l?void 0:l.length)||0,", Tests: ").concat((null===(o=e.details.tests)||void 0===o?void 0:o.length)||0):"".concat(e.hours,"h de travail, ").concat(e.commits," commits");return(0,a.jsxs)("tr",{className:"".concat(t%2==0?"bg-white dark:bg-[rgb(var(--night-surface))]":"bg-gray-50 dark:bg-gray-900/50"," hover:bg-blue-50 dark:hover:bg-blue-900/20 transition-colors cursor-pointer"),title:i,onClick:()=>n&&_(e),children:[(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 font-medium",children:d.toLocaleDateString("fr-FR",{day:"2-digit",month:"2-digit",year:"numeric"})}),(0,a.jsxs)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center font-bold text-primary-600 dark:text-primary-400",children:["~",e.hours.toFixed(1),"h"]}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center font-bold",children:e.commits}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.dev>0?e.dev:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.fix>0?e.fix:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.test>0?e.test:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.doc>0?e.doc:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.refactor>0?e.refactor:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.deploy>0?e.deploy:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.uiux>0?e.uiux:"-"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:e.optim>0?e.optim:"-"}),n&&(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(0,a.jsx)("button",{onClick:t=>{t.stopPropagation(),_(e)},className:"px-3 py-1 bg-blue-500 hover:bg-blue-600 text-white rounded-lg text-sm transition-colors",title:"Voir les d\xe9tails",children:"\uD83D\uDCCB"})})]},t)}),(0,a.jsxs)("tr",{className:"bg-gradient-to-r from-gray-100 to-gray-50 dark:from-gray-800 dark:to-gray-700 font-bold",children:[(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600",children:"Total"}),(0,a.jsxs)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center text-primary-600 dark:text-primary-400",children:["~",k.totalHours.toFixed(1),"h"]}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:k.totalCommits}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(r=k.categories["D\xe9veloppement"])||void 0===r?void 0:r.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(l=k.categories.Correction)||void 0===l?void 0:l.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(u=k.categories.Test)||void 0===u?void 0:u.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(g=k.categories.Documentation)||void 0===g?void 0:g.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(h=k.categories.Refactoring)||void 0===h?void 0:h.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(x=k.categories["D\xe9ploiement"])||void 0===x?void 0:x.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(b=k.categories["UI/UX"])||void 0===b?void 0:b.toFixed(1))||"0"}),(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600 text-center",children:(null===(p=k.categories.Optimisation)||void 0===p?void 0:p.toFixed(1))||"0"}),k.dailyData.some(e=>e.details&&(e.details.advances&&e.details.advances.length>0||e.details.fixes&&e.details.fixes.length>0||e.details.deployments&&e.details.deployments.length>0||e.details.tests&&e.details.tests.length>0))&&(0,a.jsx)("td",{className:"px-4 py-3 border border-gray-300 dark:border-gray-600"})]})]})]})})]}),(0,a.jsx)(m,{day:T,isOpen:O,onClose:H})]})]})}function p(){let[e,t]=(0,s.useState)(null),[r,l]=(0,s.useState)(!0),[o,i]=(0,s.useState)(null),[c,m]=(0,s.useState)(null),{fetchWithAuth:u,API_URL:g}=(0,n.a)();if((0,s.useEffect)(()=>{(async()=>{try{let e;l(!0);let r=await u("".concat(g,"/api.php/admin/database-view"),{method:"GET"},{requiresAuth:!0});if(!r.ok){let e=await r.text();throw Error("HTTP ".concat(r.status,": ").concat(e.substring(0,200)))}if(!(r.headers.get("content-type")||"").includes("application/json")){let e=await r.text();throw Error("R\xe9ponse non-JSON: ".concat(e.substring(0,200)))}let a=await r.text();if(!a||!a.trim())throw Error("R\xe9ponse vide du serveur");try{e=JSON.parse(a)}catch(e){throw d.Z.error("Erreur parsing JSON:",e),d.Z.error("Texte re\xe7u:",a.substring(0,500)),Error("Erreur parsing JSON: ".concat(e.message))}if(e.success)t(e.data);else throw Error(e.error||"Erreur lors du chargement")}catch(e){d.Z.error("Erreur chargement base de donn\xe9es:",e),i(e.message||"Impossible de charger les informations de la base de donn\xe9es")}finally{l(!1)}})()},[u,g]),r)return(0,a.jsx)("div",{className:"fixed inset-0 top-16 left-64 right-0 bottom-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-500 mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:"Chargement de la base de donn\xe9es..."})]})});if(o)return(0,a.jsx)("div",{className:"fixed inset-0 top-16 left-64 right-0 bottom-0 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center max-w-md",children:[(0,a.jsx)("div",{className:"text-red-500 text-4xl mb-4",children:"❌"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-800 dark:text-gray-200 mb-2",children:"Erreur"}),(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400",children:o})]})});if(!e)return null;let h=c?e.tables.find(e=>e.name===c):null;return(0,a.jsx)("div",{className:"fixed inset-0 top-16 left-64 right-0 bottom-0 overflow-y-auto bg-gradient-to-b from-gray-50 to-white dark:from-[rgb(var(--night-bg-start))] dark:to-[rgb(var(--night-bg-mid))] docs-scrollbar",children:(0,a.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,a.jsxs)("div",{className:"bg-gradient-to-r from-primary-500 to-secondary-500 rounded-lg shadow-lg p-6 mb-6 text-white",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold mb-2",children:"\uD83D\uDDC4️ Base de Donn\xe9es"}),(0,a.jsxs)("p",{className:"text-white/90",children:["Base de donn\xe9es: ",(0,a.jsx)("strong",{children:e.database_name})]}),(0,a.jsxs)("p",{className:"text-white/80 text-sm mt-2",children:[e.tables.length," table",e.tables.length>1?"s":""," disponible",e.tables.length>1?"s":""]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,a.jsx)("div",{className:"lg:col-span-1",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-4",children:[(0,a.jsx)("h2",{className:"text-xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:"Tables"}),(0,a.jsx)("div",{className:"space-y-2 max-h-[calc(100vh-300px)] overflow-y-auto",children:e.tables.map(e=>(0,a.jsx)("button",{onClick:()=>m(e.name),className:"w-full text-left px-4 py-3 rounded-lg transition-all ".concat(c===e.name?"bg-primary-500 text-white":"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300 hover:bg-gray-200 dark:hover:bg-gray-700"),children:(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("span",{className:"font-medium",children:e.name}),(0,a.jsx)("span",{className:"text-xs px-2 py-1 rounded ".concat(c===e.name?"bg-white/20 text-white":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400"),children:e.row_count})]})},e.name))})]})}),(0,a.jsx)("div",{className:"lg:col-span-2",children:h?(0,a.jsx)("div",{className:"space-y-6",children:(0,a.jsxs)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6",children:[(0,a.jsxs)("h2",{className:"text-2xl font-bold mb-4 text-gray-800 dark:text-gray-200",children:["Table: ",h.name]}),(0,a.jsxs)("p",{className:"text-gray-600 dark:text-gray-400 mb-4",children:[(0,a.jsx)("strong",{children:h.row_count})," ligne",h.row_count>1?"s":""]}),(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200",children:"Colonnes"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsxs)("tr",{className:"bg-gray-100 dark:bg-gray-800",children:[(0,a.jsx)("th",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-left",children:"Nom"}),(0,a.jsx)("th",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-left",children:"Type"}),(0,a.jsx)("th",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-left",children:"Nullable"}),(0,a.jsx)("th",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-left",children:"D\xe9faut"})]})}),(0,a.jsx)("tbody",{children:h.columns.map((e,t)=>(0,a.jsxs)("tr",{className:t%2==0?"bg-white dark:bg-[rgb(var(--night-surface))]":"bg-gray-50 dark:bg-gray-900/50",children:[(0,a.jsx)("td",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 font-mono text-sm",children:e.column_name}),(0,a.jsx)("td",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm",children:e.data_type}),(0,a.jsx)("td",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm",children:"YES"===e.is_nullable?"✅":"❌"}),(0,a.jsx)("td",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-sm font-mono",children:e.column_default||"-"})]},t))})]})})]}),h.sample&&h.sample.length>0&&(0,a.jsxs)("div",{children:[(0,a.jsx)("h3",{className:"text-lg font-semibold mb-3 text-gray-800 dark:text-gray-200",children:"\xc9chantillon (10 premi\xe8res lignes)"}),(0,a.jsx)("div",{className:"overflow-x-auto",children:(0,a.jsxs)("table",{className:"min-w-full border-collapse",children:[(0,a.jsx)("thead",{children:(0,a.jsx)("tr",{className:"bg-gray-100 dark:bg-gray-800",children:Object.keys(h.sample[0]).map(e=>(0,a.jsx)("th",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-left text-xs",children:e},e))})}),(0,a.jsx)("tbody",{children:h.sample.map((e,t)=>(0,a.jsx)("tr",{className:t%2==0?"bg-white dark:bg-[rgb(var(--night-surface))]":"bg-gray-50 dark:bg-gray-900/50",children:Object.values(e).map((e,t)=>(0,a.jsx)("td",{className:"px-4 py-2 border border-gray-300 dark:border-gray-600 text-xs",children:null===e?(0,a.jsx)("span",{className:"text-gray-400 italic",children:"NULL"}):"string"==typeof e&&e.length>50?(0,a.jsxs)("span",{title:e,children:[e.substring(0,50),"..."]}):String(e)},t))},t))})]})})]})]})}):(0,a.jsx)("div",{className:"bg-white dark:bg-[rgb(var(--night-surface))] rounded-lg shadow-lg p-6",children:(0,a.jsx)("p",{className:"text-gray-600 dark:text-gray-400 text-center",children:"S\xe9lectionnez une table pour voir ses d\xe9tails"})})})]})]})})}},9999:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return m},a:function(){return u}});var a=r(7437),s=r(2265),l=r(8828);let o=(0,s.createContext)(),d="https://ott-jbln.onrender.com".replace(/\/$/,""),n=e=>/^https?:\/\//i.test(e),i=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?n(e)?e:e.startsWith("/")?"".concat(d).concat(e):"".concat(d,"/").concat(e):d},c=e=>i(e);function m(e){let{children:t}=e,[r,n]=(0,s.useState)(null),[i,m]=(0,s.useState)(null),[u,g]=(0,s.useState)(!0);(0,s.useEffect)(()=>{l.Z.debug("[AuthContext] Initialisation...");try{let e=localStorage.getItem("ott_token"),t=localStorage.getItem("ott_user");if(l.Z.debug("[AuthContext] localStorage:",{hasToken:!!e,hasUser:!!t,tokenLength:(null==e?void 0:e.length)||0}),e&&t)try{let r=JSON.parse(t);m(e),n(r),l.Z.debug("[AuthContext] Utilisateur restaur\xe9:",r.email||r.username)}catch(e){l.Z.error("[AuthContext] Erreur parsing user:",e),localStorage.removeItem("ott_token"),localStorage.removeItem("ott_user")}else l.Z.debug("[AuthContext] Aucun utilisateur stock\xe9")}catch(e){l.Z.error("[AuthContext] Erreur lors de l'initialisation:",e)}finally{g(!1),l.Z.debug("[AuthContext] Initialisation termin\xe9e, loading=false")}},[]);let h=async(e,t)=>{try{let r=await fetch(c("/api.php/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),a=r.headers.get("content-type")||"",s=a.includes("application/json");if(!r.ok||!s){let e=await r.text();l.Z.error("[AuthContext] ❌ Erreur serveur"),l.Z.error("[AuthContext] Status:",r.status),l.Z.error("[AuthContext] Content-Type:",a),l.Z.error("[AuthContext] R\xe9ponse compl\xe8te:",e);let t="Erreur serveur (".concat(r.status,")");try{let r=JSON.parse(e);t=r.error||r.message||t}catch(a){if(e.includes("Parse error")||e.includes("Fatal error")||e.includes("Warning")){let a=e.match(/(?:Parse error|Fatal error|Warning):\s*(.+?)(?:\n|$)/i);t=a?"Erreur PHP: ".concat(a[1].substring(0,200)):"Erreur serveur (".concat(r.status,"). L'API distante ne r\xe9pond pas correctement.")}else e.includes("Database")||e.includes("Connection")?t="Erreur de connexion \xe0 la base de donn\xe9es":500===r.status&&(t="Erreur serveur interne. L'API distante rencontre un probl\xe8me.")}{let t="[".concat(new Date().toISOString(),"] ERREUR API\n")+"URL: ".concat(c("/api.php/auth/login"),"\n")+"Status: ".concat(r.status,"\n")+"Content-Type: ".concat(a,"\n")+"R\xe9ponse: ".concat(e.substring(0,1e3),"\n\n");try{localStorage.setItem("api_error_log",t),l.Z.debug("[AuthContext] \uD83D\uDCBE Log sauvegard\xe9 dans localStorage")}catch(e){l.Z.error("[AuthContext] Erreur sauvegarde log:",e)}}throw Error(t)}let o=await r.json();if(!o.success)throw Error(o.error||"Erreur de connexion");return m(o.token),n(o.user),localStorage.setItem("ott_token",o.token),localStorage.setItem("ott_user",JSON.stringify(o.user)),o}catch(e){if(e.message&&e.message.includes("Erreur serveur"))throw e;throw l.Z.error("[AuthContext] ❌ Erreur lors de la connexion:",e),Error("Erreur de connexion au serveur. V\xe9rifiez votre connexion internet.")}},x=()=>{m(null),n(null),localStorage.removeItem("ott_token"),localStorage.removeItem("ott_user")},b=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{requiresAuth:a=!1}=r,s={...t},l={...t.headers||{}};if(s.body&&!l["Content-Type"]&&(l["Content-Type"]="application/json"),i)l.Authorization="Bearer ".concat(i);else throw Error("Non authentifi\xe9");s.headers=l;let o=c(e),d=await fetch(o,s);if(401===d.status&&i)throw x(),Error("Session expir\xe9e");return d};return(0,a.jsx)(o.Provider,{value:{user:r,token:i,loading:u,login:h,logout:x,fetchWithAuth:b,API_URL:d},children:t})}let u=()=>{let e=(0,s.useContext)(o);if(!e)throw Error("useAuth doit \xeatre utilis\xe9 dans AuthProvider");return e}},8828:function(e,t,r){"use strict";r.d(t,{k:function(){return a}}),r(257);let a={log:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];console.error("[ERROR]",...t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]}};t.Z=a},7062:function(e,t,r){"use strict";r.d(t,{kj:function(){return l},vV:function(){return s},wE:function(){return a}});let a=e=>(e.startsWith("/")||(e="/".concat(e)),"".concat("/OTT").concat(e)),s=e=>/\S+@\S+\.\S+/.test(e||""),l=e=>{if(!e)return!0;let t=e.replace(/\s/g,"");return/^(\+33|0)[1-9](\d{2}){4}$/.test(t)}}},function(e){e.O(0,[7674,4328,2971,2117,1744],function(){return e(e.s=5666)}),_N_E=e.O()}]);