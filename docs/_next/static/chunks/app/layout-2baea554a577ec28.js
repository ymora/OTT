(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3185],{526:function(e,t,r){Promise.resolve().then(r.t.bind(r,7960,23)),Promise.resolve().then(r.bind(r,9999)),Promise.resolve().then(r.t.bind(r,8003,23)),Promise.resolve().then(r.t.bind(r,7151,23))},9999:function(e,t,r){"use strict";r.d(t,{AuthProvider:function(){return f},a:function(){return d}});var n=r(7437),o=r(2265),i=r(8828);let a=(0,o.createContext)(),u="https://ott-jbln.onrender.com".replace(/\/$/,""),l=e=>/^https?:\/\//i.test(e),s=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e?l(e)?e:e.startsWith("/")?"".concat(u).concat(e):"".concat(u,"/").concat(e):u},c=e=>s(e);function f(e){let{children:t}=e,[r,l]=(0,o.useState)(null),[s,f]=(0,o.useState)(null),[d,p]=(0,o.useState)(!0);(0,o.useEffect)(()=>{i.Z.debug("[AuthContext] Initialisation...");try{let e=localStorage.getItem("ott_token"),t=localStorage.getItem("ott_user");if(i.Z.debug("[AuthContext] localStorage:",{hasToken:!!e,hasUser:!!t,tokenLength:(null==e?void 0:e.length)||0}),e&&t)try{let r=JSON.parse(t);f(e),l(r),i.Z.debug("[AuthContext] Utilisateur restaur\xe9:",r.email||r.username)}catch(e){i.Z.error("[AuthContext] Erreur parsing user:",e),localStorage.removeItem("ott_token"),localStorage.removeItem("ott_user")}else i.Z.debug("[AuthContext] Aucun utilisateur stock\xe9")}catch(e){i.Z.error("[AuthContext] Erreur lors de l'initialisation:",e)}finally{p(!1),i.Z.debug("[AuthContext] Initialisation termin\xe9e, loading=false")}},[]);let h=async(e,t)=>{try{let r=await fetch(c("/api.php/auth/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}),n=r.headers.get("content-type")||"",o=n.includes("application/json");if(!r.ok||!o){let e=await r.text();i.Z.error("[AuthContext] ❌ Erreur serveur"),i.Z.error("[AuthContext] Status:",r.status),i.Z.error("[AuthContext] Content-Type:",n),i.Z.error("[AuthContext] R\xe9ponse compl\xe8te:",e);let t="Erreur serveur (".concat(r.status,")");try{let r=JSON.parse(e);t=r.error||r.message||t}catch(n){if(e.includes("Parse error")||e.includes("Fatal error")||e.includes("Warning")){let n=e.match(/(?:Parse error|Fatal error|Warning):\s*(.+?)(?:\n|$)/i);t=n?"Erreur PHP: ".concat(n[1].substring(0,200)):"Erreur serveur (".concat(r.status,"). L'API distante ne r\xe9pond pas correctement.")}else e.includes("Database")||e.includes("Connection")?t="Erreur de connexion \xe0 la base de donn\xe9es":500===r.status&&(t="Erreur serveur interne. L'API distante rencontre un probl\xe8me.")}{let t="[".concat(new Date().toISOString(),"] ERREUR API\n")+"URL: ".concat(c("/api.php/auth/login"),"\n")+"Status: ".concat(r.status,"\n")+"Content-Type: ".concat(n,"\n")+"R\xe9ponse: ".concat(e.substring(0,1e3),"\n\n");try{localStorage.setItem("api_error_log",t),i.Z.debug("[AuthContext] \uD83D\uDCBE Log sauvegard\xe9 dans localStorage")}catch(e){i.Z.error("[AuthContext] Erreur sauvegarde log:",e)}}throw Error(t)}let a=await r.json();if(!a.success)throw Error(a.error||"Erreur de connexion");return f(a.token),l(a.user),localStorage.setItem("ott_token",a.token),localStorage.setItem("ott_user",JSON.stringify(a.user)),a}catch(e){if(e.message&&e.message.includes("Erreur serveur"))throw e;throw i.Z.error("[AuthContext] ❌ Erreur lors de la connexion:",e),Error("Erreur de connexion au serveur. V\xe9rifiez votre connexion internet.")}},g=()=>{f(null),l(null),localStorage.removeItem("ott_token"),localStorage.removeItem("ott_user")},y=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},{requiresAuth:n=!1}=r,o={...t},i={...t.headers||{}};if(o.body&&!i["Content-Type"]&&(i["Content-Type"]="application/json"),s)i.Authorization="Bearer ".concat(s);else throw Error("Non authentifi\xe9");o.headers=i;let a=c(e),u=await fetch(a,o);if(401===u.status&&s)throw g(),Error("Session expir\xe9e");return u};return(0,n.jsx)(a.Provider,{value:{user:r,token:s,loading:d,login:h,logout:g,fetchWithAuth:y,API_URL:u},children:t})}let d=()=>{let e=(0,o.useContext)(a);if(!e)throw Error("useAuth doit \xeatre utilis\xe9 dans AuthProvider");return e}},8828:function(e,t,r){"use strict";r.d(t,{k:function(){return n}}),r(257);let n={log:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},error:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];console.error("[ERROR]",...t)},warn:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]},debug:function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r]}};t.Z=n},257:function(e,t,r){"use strict";var n,o;e.exports=(null==(n=r.g.process)?void 0:n.env)&&"object"==typeof(null==(o=r.g.process)?void 0:o.env)?r.g.process:r(4227)},8221:function(e,t){"use strict";let r;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{DOMAttributeNames:function(){return n},default:function(){return a},isEqualNode:function(){return i}});let n={acceptCharset:"accept-charset",className:"class",htmlFor:"for",httpEquiv:"http-equiv",noModule:"noModule"};function o(e){let{type:t,props:r}=e,o=document.createElement(t);for(let e in r){if(!r.hasOwnProperty(e)||"children"===e||"dangerouslySetInnerHTML"===e||void 0===r[e])continue;let i=n[e]||e.toLowerCase();"script"===t&&("async"===i||"defer"===i||"noModule"===i)?o[i]=!!r[e]:o.setAttribute(i,r[e])}let{children:i,dangerouslySetInnerHTML:a}=r;return a?o.innerHTML=a.__html||"":i&&(o.textContent="string"==typeof i?i:Array.isArray(i)?i.join(""):""),o}function i(e,t){if(e instanceof HTMLElement&&t instanceof HTMLElement){let r=t.getAttribute("nonce");if(r&&!e.getAttribute("nonce")){let n=t.cloneNode(!0);return n.setAttribute("nonce",""),n.nonce=r,r===e.nonce&&e.isEqualNode(n)}}return e.isEqualNode(t)}function a(){return{mountedInstances:new Set,updateHead:e=>{let t={};e.forEach(e=>{if("link"===e.type&&e.props["data-optimized-fonts"]){if(document.querySelector('style[data-href="'+e.props["data-href"]+'"]'))return;e.props.href=e.props["data-href"],e.props["data-href"]=void 0}let r=t[e.type]||[];r.push(e),t[e.type]=r});let n=t.title?t.title[0]:null,o="";if(n){let{children:e}=n.props;o="string"==typeof e?e:Array.isArray(e)?e.join(""):""}o!==document.title&&(document.title=o),["meta","base","link","style","script"].forEach(e=>{r(e,t[e]||[])})}}}r=(e,t)=>{let r=document.getElementsByTagName("head")[0],n=r.querySelector("meta[name=next-head-count]"),a=Number(n.content),u=[];for(let t=0,r=n.previousElementSibling;t<a;t++,r=(null==r?void 0:r.previousElementSibling)||null){var l;(null==r?void 0:null==(l=r.tagName)?void 0:l.toLowerCase())===e&&u.push(r)}let s=t.map(o).filter(e=>{for(let t=0,r=u.length;t<r;t++)if(i(u[t],e))return u.splice(t,1),!1;return!0});u.forEach(e=>{var t;return null==(t=e.parentNode)?void 0:t.removeChild(e)}),s.forEach(e=>r.insertBefore(e,n)),n.content=(a-u.length+s.length).toString()},("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},3515:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{cancelIdleCallback:function(){return n},requestIdleCallback:function(){return r}});let r="undefined"!=typeof self&&self.requestIdleCallback&&self.requestIdleCallback.bind(window)||function(e){let t=Date.now();return self.setTimeout(function(){e({didTimeout:!1,timeRemaining:function(){return Math.max(0,50-(Date.now()-t))}})},1)},n="undefined"!=typeof self&&self.cancelIdleCallback&&self.cancelIdleCallback.bind(window)||function(e){return clearTimeout(e)};("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},8003:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var r in t)Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}(t,{default:function(){return b},handleClientScriptLoad:function(){return y},initScriptLoader:function(){return m}});let n=r(7043),o=r(3099),i=r(7437),a=n._(r(4887)),u=o._(r(2265)),l=r(8701),s=r(8221),c=r(3515),f=new Map,d=new Set,p=["onLoad","onReady","dangerouslySetInnerHTML","children","onError","strategy","stylesheets"],h=e=>{if(a.default.preinit){e.forEach(e=>{a.default.preinit(e,{as:"style"})});return}if("undefined"!=typeof window){let t=document.head;e.forEach(e=>{let r=document.createElement("link");r.type="text/css",r.rel="stylesheet",r.href=e,t.appendChild(r)})}},g=e=>{let{src:t,id:r,onLoad:n=()=>{},onReady:o=null,dangerouslySetInnerHTML:i,children:a="",strategy:u="afterInteractive",onError:l,stylesheets:c}=e,g=r||t;if(g&&d.has(g))return;if(f.has(t)){d.add(g),f.get(t).then(n,l);return}let y=()=>{o&&o(),d.add(g)},m=document.createElement("script"),v=new Promise((e,t)=>{m.addEventListener("load",function(t){e(),n&&n.call(this,t),y()}),m.addEventListener("error",function(e){t(e)})}).catch(function(e){l&&l(e)});for(let[r,n]of(i?(m.innerHTML=i.__html||"",y()):a?(m.textContent="string"==typeof a?a:Array.isArray(a)?a.join(""):"",y()):t&&(m.src=t,f.set(t,v)),Object.entries(e))){if(void 0===n||p.includes(r))continue;let e=s.DOMAttributeNames[r]||r.toLowerCase();m.setAttribute(e,n)}"worker"===u&&m.setAttribute("type","text/partytown"),m.setAttribute("data-nscript",u),c&&h(c),document.body.appendChild(m)};function y(e){let{strategy:t="afterInteractive"}=e;"lazyOnload"===t?window.addEventListener("load",()=>{(0,c.requestIdleCallback)(()=>g(e))}):g(e)}function m(e){e.forEach(y),[...document.querySelectorAll('[data-nscript="beforeInteractive"]'),...document.querySelectorAll('[data-nscript="beforePageRender"]')].forEach(e=>{let t=e.id||e.getAttribute("src");d.add(t)})}function v(e){let{id:t,src:r="",onLoad:n=()=>{},onReady:o=null,strategy:s="afterInteractive",onError:f,stylesheets:p,...h}=e,{updateScripts:y,scripts:m,getIsSsr:v,appDir:b,nonce:_}=(0,u.useContext)(l.HeadManagerContext),E=(0,u.useRef)(!1);(0,u.useEffect)(()=>{let e=t||r;E.current||(o&&e&&d.has(e)&&o(),E.current=!0)},[o,t,r]);let x=(0,u.useRef)(!1);if((0,u.useEffect)(()=>{!x.current&&("afterInteractive"===s?g(e):"lazyOnload"===s&&("complete"===document.readyState?(0,c.requestIdleCallback)(()=>g(e)):window.addEventListener("load",()=>{(0,c.requestIdleCallback)(()=>g(e))})),x.current=!0)},[e,s]),("beforeInteractive"===s||"worker"===s)&&(y?(m[s]=(m[s]||[]).concat([{id:t,src:r,onLoad:n,onReady:o,onError:f,...h}]),y(m)):v&&v()?d.add(t||r):v&&!v()&&g(e)),b){if(p&&p.forEach(e=>{a.default.preinit(e,{as:"style"})}),"beforeInteractive"===s)return r?(a.default.preload(r,h.integrity?{as:"script",integrity:h.integrity,nonce:_,crossOrigin:h.crossOrigin}:{as:"script",nonce:_,crossOrigin:h.crossOrigin}),(0,i.jsx)("script",{nonce:_,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([r,{...h,id:t}])+")"}})):(h.dangerouslySetInnerHTML&&(h.children=h.dangerouslySetInnerHTML.__html,delete h.dangerouslySetInnerHTML),(0,i.jsx)("script",{nonce:_,dangerouslySetInnerHTML:{__html:"(self.__next_s=self.__next_s||[]).push("+JSON.stringify([0,{...h,id:t}])+")"}}));"afterInteractive"===s&&r&&a.default.preload(r,h.integrity?{as:"script",integrity:h.integrity,nonce:_,crossOrigin:h.crossOrigin}:{as:"script",nonce:_,crossOrigin:h.crossOrigin})}return null}Object.defineProperty(v,"__nextScript",{value:!0});let b=v;("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4227:function(e){!function(){var t={229:function(e){var t,r,n,o=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function u(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(r){try{return t.call(null,e,0)}catch(r){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var l=[],s=!1,c=-1;function f(){s&&n&&(s=!1,n.length?l=n.concat(l):c=-1,l.length&&d())}function d(){if(!s){var e=u(f);s=!0;for(var t=l.length;t;){for(n=l,l=[];++c<t;)n&&n[c].run();c=-1,t=l.length}n=null,s=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function p(e,t){this.fun=e,this.array=t}function h(){}o.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)t[r-1]=arguments[r];l.push(new p(e,t)),1!==l.length||s||u(d)},p.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=h,o.addListener=h,o.once=h,o.off=h,o.removeListener=h,o.removeAllListeners=h,o.emit=h,o.prependListener=h,o.prependOnceListener=h,o.listeners=function(e){return[]},o.binding=function(e){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},r={};function n(e){var o=r[e];if(void 0!==o)return o.exports;var i=r[e]={exports:{}},a=!0;try{t[e](i,i.exports,n),a=!1}finally{a&&delete r[e]}return i.exports}n.ab="//";var o=n(229);e.exports=o}()},7960:function(){},7151:function(e){e.exports={style:{fontFamily:"'__Inter_e97114', '__Inter_Fallback_e97114'",fontStyle:"normal"},className:"__className_e97114"}}},function(e){e.O(0,[8161,2971,2117,1744],function(){return e(e.s=526)}),_N_E=e.O()}]);