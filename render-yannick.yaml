# ================================================================================
# Render Configuration - OTT Dashboard YANNICK
# ================================================================================
# Service personnel de Yannick - Branche yannick
# HAPPLYZ MEDICAL SAS
# ================================================================================

services:
  # =============================================================
  # Service Yannick (Développement) - Branche yannick
  # =============================================================
  - type: web
    name: ott-dashboard-yannick
    env: docker
    repo: https://github.com/ymora/OTT.git
    rootDir: .
    branch: yannick
    dockerfilePath: ./Dockerfile
    dockerContext: .
    plan: free
    region: frankfurt
    healthCheckPath: /api.php/health
    autoDeploy: true
    envVars:
      # ================================================================================
      # ENVIRONNEMENT
      # ================================================================================
      - key: NODE_ENV
        value: development
      - key: APP_ENV
        value: development
      
      # ================================================================================
      # API BACKEND (PHP) - CONFIGURATION YANNICK
      # ================================================================================
      - key: NEXT_PUBLIC_API_MODE
        value: development
      - key: NEXT_PUBLIC_API_URL
        value: https://ott-dashboard-yannick.onrender.com
      
      # ================================================================================
      # BASE DE DONNÉES (PostgreSQL) - SHARED
      # ================================================================================
      - key: DATABASE_URL
        value: postgresql://ott_data_user:lxNCXElZadbthGiOgT3cg2Y6JmMeMqUM@dpg-d4b6c015pdvs73ck6rp0-a.frankfurt-postgres.render.com/ott_data
      - key: DB_HOST
        value: dpg-d4b6c015pdvs73ck6rp0-a.frankfurt-postgres.render.com
      - key: DB_PORT
        value: 5432
      - key: DB_NAME
        value: ott_data
      - key: DB_USER
        value: ott_data_user
      - key: DB_PASSWORD
        value: lxNCXElZadbthGiOgT3cg2Y6JmMeMqUM
      
      # ================================================================================
      # JWT & SÉCURITÉ
      # ================================================================================
      - key: JWT_SECRET
        value: happlyz_medical_ott_jwt_secret_2024_production
      - key: AUTH_DISABLED
        value: false
      
      # ================================================================================
      # CORS (API PHP) - YANNICK
      # ================================================================================
      - key: CORS_ALLOWED_ORIGINS
        value: https://ott-dashboard-yannick.onrender.com,https://ott-jbln.onrender.com,https://ott-dashboard-maxime.onrender.com
      
      # ================================================================================
      # FONCTIONNALITÉS OPTIONNELLES
      # ================================================================================
      - key: NEXT_PUBLIC_ENABLE_DEMO_RESET
        value: false
      - key: DEBUG_ERRORS
        value: true

# ================================================================================
# Base de données partagée (doit exister)
# ================================================================================
databases:
  - name: ott-data
    databaseName: ott_data
    user: ott_data_user
    plan: free
    region: frankfurt
